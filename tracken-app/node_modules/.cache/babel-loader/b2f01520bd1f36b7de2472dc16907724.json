{"ast":null,"code":"import _classCallCheck from \"/home/vlad/Desktop/repos/jfdd11-nan-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/vlad/Desktop/repos/jfdd11-nan-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/vlad/Desktop/repos/jfdd11-nan-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/vlad/Desktop/repos/jfdd11-nan-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/vlad/Desktop/repos/jfdd11-nan-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/vlad/Desktop/repos/jfdd11-nan-app/src/contexts/AuthContext.js\";\nimport React, { Component } from \"react\";\nimport firebase from \"firebase\"; // The argument passed to `createContext` is being used only\n// if given context provider is not available within VDOM\n// tree above the Consumer.\n\nexport var AuthContext = React.createContext({\n  user: null\n});\nvar Provider = AuthContext.Provider,\n    Consumer = AuthContext.Consumer;\n\nvar AuthContextProvider =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AuthContextProvider, _Component);\n\n  function AuthContextProvider() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AuthContextProvider);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AuthContextProvider)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      user: null,\n      userData: {\n        company_name: \"\",\n        name: \"\",\n        surname: \"\",\n        nip: \"\",\n        phone: \"\",\n        city: \"\",\n        postalcode: \"\",\n        street: \"\",\n        number: \"\"\n      },\n      signOut: function signOut() {\n        return firebase.auth().signOut();\n      },\n      signIn: function signIn(email, password) {\n        return firebase.auth().signInWithEmailAndPassword(email, password);\n      }\n    };\n    _this.userDbRef = null;\n\n    _this.readUserData = function (snapshot) {\n      var person = snapshot.val();\n\n      if (person === null) {\n        return;\n      }\n\n      _this.setState({\n        userData: {\n          name: person.name,\n          surname: person.surname,\n          company_name: person.company_name,\n          nip: person.nip,\n          phone: person.phone,\n          city: person.city,\n          postalcode: person.postalcode,\n          street: person.street,\n          number: person.number\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(AuthContextProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.unsubscribe = firebase.auth().onAuthStateChanged(function (user) {\n        _this2.setState({\n          user: user\n        });\n\n        if (user !== null) {\n          _this2.userDbRef = firebase.database().ref(\"users/\".concat(user.uid));\n\n          _this2.userDbRef.on(\"value\", _this2.readUserData);\n        } else {// this.userDbRef.off(\"value\", this.readUserData);\n        }\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unsubscribe();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(Provider, {\n        value: this.state,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, this.props.children);\n    }\n  }]);\n\n  return AuthContextProvider;\n}(Component); // HOC - Higher Order Component\n\n\nexport { AuthContextProvider as default };\nexport var withAuth = function withAuth(Component) {\n  return function (props) {\n    return React.createElement(Consumer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, function (value) {\n      return React.createElement(Component, Object.assign({}, props, {\n        authContext: value,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }));\n    });\n  };\n};","map":{"version":3,"sources":["/home/vlad/Desktop/repos/jfdd11-nan-app/src/contexts/AuthContext.js"],"names":["React","Component","firebase","AuthContext","createContext","user","Provider","Consumer","AuthContextProvider","state","userData","company_name","name","surname","nip","phone","city","postalcode","street","number","signOut","auth","signIn","email","password","signInWithEmailAndPassword","userDbRef","readUserData","snapshot","person","val","setState","unsubscribe","onAuthStateChanged","database","ref","uid","on","props","children","withAuth","value"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport firebase from \"firebase\";\n\n// The argument passed to `createContext` is being used only\n// if given context provider is not available within VDOM\n// tree above the Consumer.\nexport const AuthContext = React.createContext({ user: null });\nconst { Provider, Consumer } = AuthContext;\n\nexport default class AuthContextProvider extends Component {\n  state = {\n    user: null,\n    userData: {\n      company_name: \"\",\n      name: \"\",\n      surname: \"\",\n      nip: \"\",\n      phone: \"\",\n      city: \"\",\n      postalcode: \"\",\n      street: \"\",\n      number: \"\"\n    },\n    signOut: () => firebase.auth().signOut(),\n    signIn: (email, password) =>\n      firebase.auth().signInWithEmailAndPassword(email, password)\n  };\n\n  userDbRef = null;\n\n  readUserData = snapshot => {\n    const person = snapshot.val();\n\n    if (person === null) {\n      return;\n    }\n\n    this.setState({\n      userData: {\n        name: person.name,\n        surname: person.surname,\n        company_name: person.company_name,\n        nip: person.nip,\n        phone: person.phone,\n        city: person.city,\n        postalcode: person.postalcode,\n        street: person.street,\n        number: person.number\n      }\n    });\n  };\n\n  componentDidMount() {\n    this.unsubscribe = firebase.auth().onAuthStateChanged(user => {\n      this.setState({ user });\n      if (user !== null) {\n        this.userDbRef = firebase.database().ref(`users/${user.uid}`);\n\n        this.userDbRef.on(\"value\", this.readUserData);\n      } else {\n       // this.userDbRef.off(\"value\", this.readUserData);\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe();\n  }\n\n  render() {\n    return <Provider value={this.state}>{this.props.children}</Provider>;\n  }\n}\n\n// HOC - Higher Order Component\nexport const withAuth = Component => props => (\n  <Consumer>{value => <Component {...props} authContext={value} />}</Consumer>\n);\n"]},"metadata":{},"sourceType":"module"}